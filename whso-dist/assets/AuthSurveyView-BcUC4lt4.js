import{d as Be,r as k,c as Q,g as Te,a as n,i as c,m as we,n as l,b as s,t as d,p as O,u as g,f as be,F as A,e as S,s as D,x as te,v as ne,k as Ne,S as b,l as Ae,o as i,_ as Se}from"./index-uWeSuK_C.js";import{u as Ie}from"./useI18n-CudI-zkr.js";import{s as ie}from"./surveyService-BDce2LuR.js";import{u as Me,T as Ee,s as Oe}from"./PublicSurveyView.module.css_vue_type_style_index_0_src_true_lang.module-Bqbhaew2.js";const Ve=["data-theme","dir"],Re=["type","pattern","onUpdate:modelValue","maxlength","onBlur","onInput","placeholder"],Ue=["data-warning"],Le=["onUpdate:modelValue","maxlength","onInput"],We=["data-warning"],Pe=["onClick"],Qe=["onClick"],De={key:0,class:"fas fa-check"},He=["onClick","aria-pressed"],Fe=["onClick","aria-pressed"],Je=["onClick"],Xe=["disabled"],ze={key:0,class:"fas fa-spinner fa-spin"},Ge={key:1,class:"fas fa-paper-plane"},Ye={key:1},je=["type","pattern","maxlength","placeholder"],Ke=["data-warning"],Ze=["maxlength"],qe=["data-warning"],xe=["onClick"],_e=["onClick"],es={key:0,class:"fas fa-check"},ss=["onClick"],ls=["aria-pressed"],as=["aria-pressed"],ts=["disabled"],ns=["disabled"],is={key:0,class:"fas fa-spinner fa-spin"},rs={key:1,class:"fas fa-paper-plane"},os=400,us=2e3,ds=Be({__name:"AuthSurveyView",setup(vs){const re=Ne(),Z=Ae(),{t:oe,currentTheme:ue,isRTL:de}=Ie(),{getInputConfig:I,validateAnswer:ye,getValidationError:M,setValidationError:ve,clearValidationError:q,handleBackendValidationErrors:ce}=Me(),p=k(null),H=k(!0),N=k(null),F=k(!1),R=k(!1),J=k(""),X=k(!1),E=k(!0),C=k(0),o=k({}),U=k(""),T=k(!1),z=k(!1),r=Q(()=>!p.value||!p.value.questions?null:p.value.questions[C.value]),pe=Q(()=>{var e;return p.value?(C.value+1)/(((e=p.value.questions)==null?void 0:e.length)||1)*100:0}),x=Q(()=>{if(!r.value)return!1;const e=o.value[r.value.id];return r.value.is_required?r.value.question_type==="multiple_choice"?Array.isArray(e)&&e.length>0:e!=null&&e!=="":!0}),G=Q(()=>{if(!p.value)return!1;for(const e of p.value.questions)if(e.is_required){const a=o.value[e.id];if(e.question_type==="multiple_choice"){if(!Array.isArray(a)||a.length===0)return!1}else if(a==null||a==="")return!1}return!0}),Y=async()=>{var e,a,y,v,m,f;try{H.value=!0,N.value=null,F.value=!1,R.value=!1;const t=re.params.id;if(!t){N.value="معرف الاستطلاع غير مُتاح",await b.fire({title:"خطأ",text:"معرف الاستطلاع غير مُتاح",icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"});return}const $=new Promise((w,K)=>{setTimeout(()=>K(new Error("TIMEOUT")),15e3)}),u=await Promise.race([ie.getAuthSurvey(t),$]);u.data&&u.data.survey?(p.value=u.data.survey,fe()):(N.value="الاستطلاع غير موجود",await b.fire({title:"خطأ",text:"الاستطلاع غير موجود",icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"}))}catch(t){let $=t.message||"فشل في تحميل الاستطلاع";(a=(e=t.response)==null?void 0:e.data)!=null&&a.message&&($=t.response.data.message),t.message==="TIMEOUT"?(F.value=!0,await b.fire({title:"انتهت مهلة الطلب",text:"فشل في تحميل الاستطلاع خلال 15 ثانية. يرجى المحاولة مرة أخرى.",icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"})):(y=t.message)!=null&&y.includes("403")||(v=t.message)!=null&&v.includes("Access denied")?(R.value=!0,J.value=$):(m=t.message)!=null&&m.includes("404")?(N.value=$,await b.fire({title:"خطأ",text:$,icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"})):(f=t.message)!=null&&f.includes("401")?(R.value=!0,J.value=$):(N.value=$,await b.fire({title:"خطأ في تحميل الاستطلاع",text:$,icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"}))}finally{H.value=!1}},fe=()=>{if(!p.value)return;const e={};p.value.questions.forEach(a=>{a.question_type==="multiple_choice"?e[a.id]=[]:e[a.id]=""}),o.value=e},$e=()=>{X.value=!0,C.value=0},me=()=>{var e;if(!x.value){U.value="يرجى الإجابة على هذا السؤال للمتابعة";return}U.value="",C.value<(((e=p.value.questions)==null?void 0:e.length)||0)-1&&C.value++},ge=()=>{C.value>0&&(C.value--,U.value="")},_=e=>{const a=o.value[e.id],y=e.validation_type||"none";if(y==="none")return;const v=ye(y,a||"",e.is_required);!v.valid&&v.error&&ve(e.id,v.error)},ee=async()=>{var e,a,y,v,m;if(!(!G.value||T.value))try{T.value=!0;const f={survey_id:p.value.id,answers:[]};for(const $ of p.value.questions){const u=o.value[$.id];if(u!=null&&u!==""){let w;$.question_type==="multiple_choice"?w=Array.isArray(u)?u.join(", "):u.toString():w=u.toString(),f.answers.push({question_id:$.id,answer_text:w})}}const t=new Promise(($,u)=>{setTimeout(()=>u(new Error("TIMEOUT")),15e3)});await Promise.race([ie.submitAuthResponse(f),t]),await b.fire({title:"تم الإرسال بنجاح",text:"تم إرسال إجابات الاستطلاع بنجاح. شكراً لمشاركتك!",icon:"success",confirmButtonText:"موافق",confirmButtonColor:"#28a745"}),z.value=!0}catch(f){if((y=(a=(e=f.response)==null?void 0:e.data)==null?void 0:a.data)!=null&&y.validation_errors){ce(f.response.data.data.validation_errors),await b.fire({title:"خطأ في التحقق من صحة البيانات",text:"يرجى تصحيح الأخطاء في الاستطلاع والمحاولة مرة أخرى",icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"});return}let t=f.message||"فشل في إرسال إجابات الاستطلاع";(m=(v=f.response)==null?void 0:v.data)!=null&&m.message&&(t=f.response.data.message),f.message==="TIMEOUT"?await b.fire({title:"انتهت مهلة الطلب",text:"فشل في إرسال الإجابات خلال 15 ثانية. يرجى المحاولة مرة أخرى.",icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"}):await b.fire({title:"خطأ في الإرسال",text:t,icon:"error",confirmButtonText:"موافق",confirmButtonColor:"#dc3545"}),U.value=t}finally{T.value=!1}},se=()=>{Z.push("/surveys")},ke=()=>{window.location.reload()},Ce=()=>{z.value=!1,Z.push("/surveys")},B=e=>e==="textarea"?us:os,V=e=>{const a=o.value[e];return a?String(a).length:0},h=(e,a)=>{const y=B(a),v=V(e);return y-v},L=(e,a,y)=>{const v=y.target,m=B(a);v.value.length>m&&(v.value=v.value.substring(0,m),o.value[e]=v.value)},j=(e,a)=>{const y=o.value[e];return Array.isArray(y)&&y.includes(a)},le=(e,a)=>{Array.isArray(o.value[e])||(o.value[e]=[]);const y=o.value[e],v=y.indexOf(a);v>-1?y.splice(v,1):y.push(a)},he=e=>{if(!e)return"1 إلى 5";try{const a=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(a)||a.length===0)return"1 إلى 5";const y=a.map(f=>Number(f)).filter(f=>!isNaN(f));if(y.length===0)return"1 إلى 5";const v=Math.min(...y),m=Math.max(...y);return`${v} إلى ${m}`}catch{return"1 إلى 5"}},W=e=>{if(!e)return[];try{const a=typeof e=="string"?JSON.parse(e):e;return Array.isArray(a)?a.map(y=>String(y)):[]}catch{return[]}},ae=e=>{if(!e)return[1,2,3,4,5];try{const a=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(a)||a.length===0)return[1,2,3,4,5];const y=a.map(v=>Number(v)).filter(v=>!isNaN(v)).sort((v,m)=>v-m);return y.length>0?y:a}catch{return[1,2,3,4,5]}},P=(e,a)=>{var v;const y=a||((v=r.value)==null?void 0:v.options);if(!y)return e==="min"?"ضعيف":"ممتاز";try{const m=typeof y=="string"?JSON.parse(y):y;if(!Array.isArray(m)||m.length===0)return e==="min"?"ضعيف":"ممتاز";const f=m.map(t=>Number(t)).filter(t=>!isNaN(t)).sort((t,$)=>t-$);return f.length===0?e==="min"?"ضعيف":"ممتاز":e==="min"?`${f[0]}`:`${f[f.length-1]}`}catch{return e==="min"?"ضعيف":"ممتاز"}};return Te(()=>{Y()}),(e,a)=>{var y,v,m,f;return i(),n("div",{class:l(e.$style.publicSurveyContainer),"data-theme":g(ue),dir:g(de)?"rtl":"ltr"},[H.value?(i(),n("div",{key:0,class:l(e.$style.loadingContainer)},[s("div",{class:l(e.$style.loadingSpinner)},null,2),s("p",{class:l(e.$style.loadingText)},"جاري تحميل الاستطلاع...",2)],2)):R.value?(i(),n("div",{key:1,class:l(e.$style.accessDenied)},[s("div",{class:l(e.$style.deniedIcon)},a[9]||(a[9]=[s("i",{class:"fas fa-lock"},null,-1)]),2),s("h2",{class:l(e.$style.deniedTitle)},"الوصول مرفوض",2),s("p",{class:l(e.$style.deniedMessage)},d(J.value),3),s("button",{class:l(e.$style.secondaryButton),onClick:se},[a[10]||(a[10]=s("i",{class:"fas fa-arrow-left"},null,-1)),O(" "+d(g(oe)("common.goBack")),1)],2)],2)):N.value?(i(),n("div",{key:2,class:l(e.$style.errorState)},[s("div",{class:l(e.$style.errorIcon)},a[11]||(a[11]=[s("i",{class:"fas fa-exclamation-triangle"},null,-1)]),2),s("h2",{class:l(e.$style.errorTitle)},"خطأ",2),s("p",{class:l(e.$style.errorMessage)},d(N.value),3),s("button",{class:l(e.$style.secondaryButton),onClick:Y},a[12]||(a[12]=[s("i",{class:"fas fa-redo"},null,-1),O(" إعادة المحاولة ")]),2)],2)):F.value?(i(),n("div",{key:3,class:l(e.$style.errorState)},[s("div",{class:l(e.$style.errorIcon)},a[13]||(a[13]=[s("i",{class:"fas fa-clock"},null,-1)]),2),s("h2",{class:l(e.$style.errorTitle)},"انتهت مهلة الطلب",2),s("p",{class:l(e.$style.errorMessage)},"فشل في تحميل الاستطلاع خلال 15 ثانية",2),s("div",{class:l(e.$style.errorActions)},[s("button",{class:l(e.$style.secondaryButton),onClick:Y},a[14]||(a[14]=[s("i",{class:"fas fa-redo"},null,-1),O(" إعادة المحاولة ")]),2),s("button",{class:l(e.$style.secondaryButton),onClick:ke},a[15]||(a[15]=[s("i",{class:"fas fa-sync-alt"},null,-1),O(" تحديث الصفحة ")]),2)],2)],2)):p.value&&!X.value?(i(),n("div",{key:4,class:l(e.$style.surveyContent)},[s("div",{class:l(e.$style.surveyHeader)},[s("div",{class:l(e.$style.surveyBranding)},[s("div",{class:l(e.$style.surveyIcon)},a[16]||(a[16]=[s("i",{class:"fas fa-clipboard-list"},null,-1)]),2),s("h1",{class:l(e.$style.surveyTitle)},d(p.value.title),3),p.value.description?(i(),n("p",{key:0,class:l(e.$style.surveyDescription)},d(p.value.description),3)):c("",!0)],2),s("div",{class:l(e.$style.surveyMeta)},[s("div",{class:l(e.$style.metaItem)},[a[17]||(a[17]=s("i",{class:"fas fa-question-circle"},null,-1)),s("span",null,d(p.value.questions_count||((y=p.value.questions)==null?void 0:y.length)||0)+" سؤال",1)],2),s("div",{class:l(e.$style.metaItem)},a[18]||(a[18]=[s("i",{class:"fas fa-user-shield"},null,-1),s("span",null,"استطلاع محمي",-1)]),2)],2)],2),s("div",{class:l(e.$style.welcomeSection)},[s("div",{class:l(e.$style.welcomeContent)},[s("div",{class:l(e.$style.welcomeIcon)},a[19]||(a[19]=[s("i",{class:"fas fa-heart"},null,-1)]),2),s("h3",{class:l(e.$style.welcomeTitle)},"أهلاً وسهلاً بك في الاستطلاع المحمي",2),s("p",{class:l(e.$style.welcomeText)},"نقدر وقتك وآرائك القيمة. هذا الاستطلاع محمي ويتطلب المصادقة للوصول إليه. إجاباتك ستساعدنا في تحسين خدماتنا وتطوير تجربة أفضل للجميع.",2)],2)],2),s("div",{class:l(e.$style.actionButtons)},[s("button",{class:l(e.$style.startButton),onClick:$e},a[20]||(a[20]=[s("i",{class:"fas fa-play"},null,-1),s("span",null,"ابدأ الاستطلاع الآن",-1)]),2),s("div",{class:l(e.$style.secondaryActions)},[s("button",{class:l(e.$style.secondaryButton),onClick:se},a[21]||(a[21]=[s("i",{class:"fas fa-arrow-left"},null,-1),s("span",null,"العودة",-1)]),2)],2)],2)],2)):p.value&&X.value?(i(),n("div",{key:5,class:l(e.$style.surveyForm)},[s("div",{class:l(e.$style.formHeader)},[s("div",{class:l(e.$style.formTitleSection)},[s("h1",{class:l(e.$style.formTitle)},d(p.value.title),3),s("div",{class:l(e.$style.formSubtitle)},a[22]||(a[22]=[s("i",{class:"fas fa-user-edit"},null,-1),s("span",null,"يرجى الإجابة على الأسئلة التالية بعناية",-1)]),2)],2),s("div",{class:l(e.$style.viewModeToggle)},[s("button",{class:l([e.$style.toggleButton,{[e.$style.active]:E.value}]),onClick:a[0]||(a[0]=t=>E.value=!0)},a[23]||(a[23]=[s("i",{class:"fas fa-list"},null,-1),s("span",null,"جميع الأسئلة",-1)]),2),s("button",{class:l([e.$style.toggleButton,{[e.$style.active]:!E.value}]),onClick:a[1]||(a[1]=t=>E.value=!1)},a[24]||(a[24]=[s("i",{class:"fas fa-step-forward"},null,-1),s("span",null,"سؤال بسؤال",-1)]),2)],2),E.value?c("",!0):(i(),n("div",{key:0,class:l(e.$style.progressSection)},[s("div",{class:l(e.$style.progressBar)},[s("div",{class:l(e.$style.progressFill),style:be({width:pe.value+"%"})},null,6)],2),s("div",{class:l(e.$style.progressInfo)},[s("span",{class:l(e.$style.progressText)}," السؤال "+d(C.value+1)+" من "+d(((v=p.value.questions)==null?void 0:v.length)||0),3)],2)],2))],2),E.value?(i(),n("div",{key:0,class:l(e.$style.allQuestionsContainer)},[(i(!0),n(A,null,S(p.value.questions,(t,$)=>(i(),n("div",{key:t.id,class:l(e.$style.currentQuestion)},[s("div",{class:l(e.$style.questionHeader)},[s("div",{class:l(e.$style.questionBadge)},[s("span",{class:l(e.$style.questionIndex)},d($+1),3)],2),s("h2",{class:l(e.$style.questionTitle)},[O(d(t.text)+" ",1),t.is_required?(i(),n("span",{key:0,class:l(e.$style.required)},"*",2)):c("",!0)],2),t.is_required?(i(),n("div",{key:0,class:l(e.$style.requiredNote)},a[25]||(a[25]=[s("i",{class:"fas fa-star"},null,-1),s("span",null,"هذا السؤال مطلوب",-1)]),2)):c("",!0)],2),t.question_type==="text"?(i(),n("div",{key:0,class:l(e.$style.inputContainer)},[s("div",{class:l(e.$style.inputWrapper)},[D(s("input",{type:g(I)(t.validation_type||"none").type,pattern:g(I)(t.validation_type||"none").pattern,class:l([e.$style.textInput,{[e.$style.inputError]:g(M)(t.id)}]),"onUpdate:modelValue":u=>o.value[t.id]=u,maxlength:B("text"),onBlur:u=>_(t),onInput:u=>{g(q)(t.id),L(t.id,"text",u)},placeholder:g(I)(t.validation_type||"none").placeholder||"اكتب إجابتك هنا..."},null,42,Re),[[te,o.value[t.id]]])],2),s("div",{class:l(e.$style.characterCount),"data-warning":h(t.id,"text")<100},[s("span",null,d(V(t.id))+" / "+d(B("text")),1),h(t.id,"text")<100?(i(),n("span",{key:0,class:l(e.$style.remainingWarning)}," ("+d(h(t.id,"text"))+" حرف متبقي) ",3)):c("",!0)],10,Ue),g(M)(t.id)?(i(),n("div",{key:0,class:l(e.$style.errorMessage)},[a[26]||(a[26]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,d(g(M)(t.id)),1)],2)):c("",!0)],2)):t.question_type==="textarea"?(i(),n("div",{key:1,class:l(e.$style.inputContainer)},[s("div",{class:l(e.$style.inputWrapper)},[D(s("textarea",{class:l(e.$style.textArea),"onUpdate:modelValue":u=>o.value[t.id]=u,maxlength:B("textarea"),onInput:u=>L(t.id,"textarea",u),placeholder:"اكتب إجابتك المفصلة هنا... يمكنك كتابة عدة أسطر",rows:"4"},null,42,Le),[[ne,o.value[t.id]]])],2),s("div",{class:l(e.$style.characterCount),"data-warning":h(t.id,"textarea")<200},[s("span",null,d(V(t.id))+" / "+d(B("textarea")),1),h(t.id,"textarea")<200?(i(),n("span",{key:0,class:l(e.$style.remainingWarning)}," ("+d(h(t.id,"textarea"))+" حرف متبقي) ",3)):c("",!0)],10,We)],2)):t.question_type==="single_choice"?(i(),n("div",{key:2,class:l(e.$style.choicesContainer)},[s("div",{class:l(e.$style.choicesTitle)},a[27]||(a[27]=[s("i",{class:"fas fa-dot-circle"},null,-1),s("span",null,"اختر إجابة واحدة:",-1)]),2),(i(!0),n(A,null,S(W(t.options),(u,w)=>(i(),n("div",{key:w,class:l([e.$style.choiceOption,{[e.$style.selected]:o.value[t.id]===u}]),onClick:K=>o.value[t.id]=u},[s("div",{class:l(e.$style.choiceRadio)},[o.value[t.id]===u?(i(),n("div",{key:0,class:l(e.$style.radioSelected)},null,2)):c("",!0)],2),s("span",{class:l(e.$style.choiceText)},d(u),3),o.value[t.id]===u?(i(),n("div",{key:0,class:l(e.$style.choiceCheck)},a[28]||(a[28]=[s("i",{class:"fas fa-check"},null,-1)]),2)):c("",!0)],10,Pe))),128))],2)):t.question_type==="multiple_choice"?(i(),n("div",{key:3,class:l(e.$style.choicesContainer)},[s("div",{class:l(e.$style.choicesTitle)},a[29]||(a[29]=[s("i",{class:"fas fa-check-square"},null,-1),s("span",null,"يمكنك اختيار أكثر من إجابة:",-1)]),2),(i(!0),n(A,null,S(W(t.options),(u,w)=>(i(),n("div",{key:w,class:l([e.$style.choiceOption,{[e.$style.multiSelected]:Array.isArray(o.value[t.id])&&o.value[t.id].includes(u)}]),onClick:K=>le(t.id,u)},[s("div",{class:l(e.$style.choiceCheckbox)},[Array.isArray(o.value[t.id])&&o.value[t.id].includes(u)?(i(),n("i",De)):c("",!0)],2),s("span",{class:l(e.$style.choiceText)},d(u),3)],10,Qe))),128))],2)):t.question_type==="yes_no"?(i(),n("div",{key:4,class:l(e.$style.yesNoWrapper)},[s("div",{class:l(e.$style.yesNoContainer)},[s("div",{class:l(e.$style.yesNoButtons)},[s("button",{class:l([e.$style.yesNoButton,e.$style.yes,{[e.$style.selected]:o.value[t.id]==="yes"}]),onClick:u=>o.value[t.id]="yes",type:"button","aria-pressed":o.value[t.id]==="yes"},[s("i",{class:l(["fas fa-check",e.$style.yesNoButtonIcon])},null,2),s("span",{class:l(e.$style.yesNoButtonText)},"نعم",2),s("div",{class:l(e.$style.yesNoButtonBadge)},a[30]||(a[30]=[s("i",{class:"fas fa-check"},null,-1)]),2)],10,He),s("button",{class:l([e.$style.yesNoButton,e.$style.no,{[e.$style.selected]:o.value[t.id]==="no"}]),onClick:u=>o.value[t.id]="no",type:"button","aria-pressed":o.value[t.id]==="no"},[s("i",{class:l(["fas fa-times",e.$style.yesNoButtonIcon])},null,2),s("span",{class:l(e.$style.yesNoButtonText)},"لا",2),s("div",{class:l(e.$style.yesNoButtonBadge)},a[31]||(a[31]=[s("i",{class:"fas fa-times"},null,-1)]),2)],10,Fe)],2)],2)],2)):t.question_type==="rating"?(i(),n("div",{key:5,class:l(e.$style.ratingContainer)},[s("div",{class:l(e.$style.ratingLabels)},[s("span",null,d(P("min",t.options)),1),s("span",null,d(P("max",t.options)),1)],2),s("div",{class:l(e.$style.ratingScale)},[(i(!0),n(A,null,S(ae(t.options),u=>(i(),n("button",{key:u,class:l([e.$style.ratingButton,{[e.$style.selected]:o.value[t.id]===u}]),onClick:w=>o.value[t.id]=u},d(u),11,Je))),128))],2)],2)):c("",!0)],2))),128)),s("div",{class:l(e.$style.submitContainer)},[s("button",{class:l([e.$style.navButton,e.$style.submit]),onClick:ee,disabled:!G.value||T.value},[T.value?(i(),n("i",ze)):(i(),n("i",Ge)),s("span",null,d(T.value?"جاري الإرسال...":"إرسال الاستطلاع"),1)],10,Xe)],2)],2)):(i(),n("div",Ye,[s("div",{class:l(e.$style.questionContainer)},[r.value?(i(),n("div",{key:0,class:l(e.$style.currentQuestion)},[s("div",{class:l(e.$style.questionHeader)},[s("div",{class:l(e.$style.questionBadge)},[s("span",{class:l(e.$style.questionIndex)},d(C.value+1),3)],2),s("h2",{class:l(e.$style.questionTitle)},[O(d(r.value.text)+" ",1),r.value.is_required?(i(),n("span",{key:0,class:l(e.$style.required)},"*",2)):c("",!0)],2),r.value.is_required?(i(),n("div",{key:0,class:l(e.$style.requiredNote)},a[32]||(a[32]=[s("i",{class:"fas fa-star"},null,-1),s("span",null,"هذا السؤال مطلوب",-1)]),2)):c("",!0)],2),r.value.question_type==="text"?(i(),n("div",{key:0,class:l(e.$style.inputContainer)},[s("div",{class:l(e.$style.inputWrapper)},[D(s("input",{type:g(I)(r.value.validation_type||"none").type,pattern:g(I)(r.value.validation_type||"none").pattern,class:l([e.$style.textInput,{[e.$style.inputError]:g(M)(r.value.id)}]),"onUpdate:modelValue":a[2]||(a[2]=t=>o.value[r.value.id]=t),maxlength:B("text"),onBlur:a[3]||(a[3]=t=>_(r.value)),onInput:a[4]||(a[4]=t=>{r.value&&(g(q)(r.value.id),L(r.value.id,"text",t))}),placeholder:g(I)(r.value.validation_type||"none").placeholder||"اكتب إجابتك هنا..."},null,42,je),[[te,o.value[r.value.id]]])],2),s("div",{class:l(e.$style.characterCount),"data-warning":h(r.value.id,"text")<100},[s("span",null,d(V(r.value.id))+" / "+d(B("text")),1),h(r.value.id,"text")<100?(i(),n("span",{key:0,class:l(e.$style.remainingWarning)}," ("+d(h(r.value.id,"text"))+" حرف متبقي) ",3)):c("",!0)],10,Ke),g(M)(r.value.id)?(i(),n("div",{key:0,class:l(e.$style.errorMessage)},[a[33]||(a[33]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,d(g(M)(r.value.id)),1)],2)):c("",!0)],2)):r.value.question_type==="textarea"?(i(),n("div",{key:1,class:l(e.$style.inputContainer)},[s("div",{class:l(e.$style.inputWrapper)},[D(s("textarea",{class:l(e.$style.textArea),"onUpdate:modelValue":a[5]||(a[5]=t=>o.value[r.value.id]=t),maxlength:B("textarea"),onInput:a[6]||(a[6]=t=>{r.value&&L(r.value.id,"textarea",t)}),placeholder:"اكتب إجابتك المفصلة هنا... يمكنك كتابة عدة أسطر",rows:"4"},null,42,Ze),[[ne,o.value[r.value.id]]])],2),s("div",{class:l(e.$style.characterCount),"data-warning":h(r.value.id,"textarea")<200},[s("span",null,d(V(r.value.id))+" / "+d(B("textarea")),1),h(r.value.id,"textarea")<200?(i(),n("span",{key:0,class:l(e.$style.remainingWarning)}," ("+d(h(r.value.id,"textarea"))+" حرف متبقي) ",3)):c("",!0)],10,qe)],2)):r.value.question_type==="single_choice"?(i(),n("div",{key:2,class:l(e.$style.choicesContainer)},[s("div",{class:l(e.$style.choicesTitle)},a[34]||(a[34]=[s("i",{class:"fas fa-dot-circle"},null,-1),s("span",null,"اختر إجابة واحدة:",-1)]),2),(i(!0),n(A,null,S(W(r.value.options),(t,$)=>(i(),n("div",{key:$,class:l([e.$style.choiceOption,{[e.$style.selected]:o.value[r.value.id]===t}]),onClick:u=>o.value[r.value.id]=t},[s("div",{class:l(e.$style.choiceRadio)},[o.value[r.value.id]===t?(i(),n("div",{key:0,class:l(e.$style.radioSelected)},null,2)):c("",!0)],2),s("span",{class:l(e.$style.choiceText)},d(t),3),o.value[r.value.id]===t?(i(),n("div",{key:0,class:l(e.$style.choiceCheck)},a[35]||(a[35]=[s("i",{class:"fas fa-check"},null,-1)]),2)):c("",!0)],10,xe))),128))],2)):r.value.question_type==="multiple_choice"?(i(),n("div",{key:3,class:l(e.$style.choicesContainer)},[s("div",{class:l(e.$style.choicesTitle)},a[36]||(a[36]=[s("i",{class:"fas fa-check-square"},null,-1),s("span",null,"يمكنك اختيار أكثر من إجابة:",-1)]),2),(i(!0),n(A,null,S(W(r.value.options),(t,$)=>(i(),n("div",{key:$,class:l([e.$style.choiceOption,{[e.$style.selected]:j(r.value.id,t)}]),onClick:u=>le(r.value.id,t)},[s("div",{class:l(e.$style.choiceCheckbox)},[j(r.value.id,t)?(i(),n("i",es)):c("",!0)],2),s("span",{class:l(e.$style.choiceText)},d(t),3),j(r.value.id,t)?(i(),n("div",{key:0,class:l(e.$style.choiceCheck)},a[37]||(a[37]=[s("i",{class:"fas fa-check-circle"},null,-1)]),2)):c("",!0)],10,_e))),128))],2)):r.value.question_type==="rating"?(i(),n("div",{key:4,class:l(e.$style.ratingContainer)},[s("div",{class:l(e.$style.ratingTitle)},[a[38]||(a[38]=s("i",{class:"fas fa-star"},null,-1)),s("span",null,"قيم من "+d(he(r.value.options))+":",1)],2),s("div",{class:l(e.$style.ratingScale)},[(i(!0),n(A,null,S(ae(r.value.options),t=>(i(),n("button",{key:t,class:l([e.$style.ratingButton,{[e.$style.selected]:o.value[r.value.id]===t}]),onClick:$=>o.value[r.value.id]=t},[s("span",{class:l(e.$style.ratingNumber)},d(t),3)],10,ss))),128))],2),s("div",{class:l(e.$style.ratingLabels)},[s("span",null,d(P("min")),1),s("span",null,d(P("max")),1)],2)],2)):r.value.question_type==="yes_no"?(i(),n("div",{key:5,class:l(e.$style.yesNoWrapper)},[s("div",{class:l(e.$style.yesNoTitle)},[s("i",{class:l(["fas fa-question-circle",e.$style.yesNoTitleIcon])},null,2),s("span",{class:l(e.$style.yesNoTitleText)},"سؤال اختيار",2)],2),s("div",{class:l(e.$style.yesNoSubtitle)},"اختر الخيار الذي يناسب رأيك",2),s("div",{class:l(e.$style.yesNoContainer)},[s("div",{class:l(e.$style.yesNoButtons)},[s("button",{class:l([e.$style.yesNoButton,e.$style.yes,{[e.$style.selected]:o.value[r.value.id]==="yes"}]),onClick:a[7]||(a[7]=t=>o.value[r.value.id]="yes"),type:"button","aria-pressed":o.value[r.value.id]==="yes"},[s("i",{class:l(["fas fa-check",e.$style.yesNoButtonIcon])},null,2),s("span",{class:l(e.$style.yesNoButtonText)},"نعم",2),s("div",{class:l(e.$style.yesNoButtonBadge)},a[39]||(a[39]=[s("i",{class:"fas fa-check"},null,-1)]),2)],10,ls),s("button",{class:l([e.$style.yesNoButton,e.$style.no,{[e.$style.selected]:o.value[r.value.id]==="no"}]),onClick:a[8]||(a[8]=t=>o.value[r.value.id]="no"),type:"button","aria-pressed":o.value[r.value.id]==="no"},[s("i",{class:l(["fas fa-times",e.$style.yesNoButtonIcon])},null,2),s("span",{class:l(e.$style.yesNoButtonText)},"لا",2),s("div",{class:l(e.$style.yesNoButtonBadge)},a[40]||(a[40]=[s("i",{class:"fas fa-times"},null,-1)]),2)],10,as)],2)],2)],2)):c("",!0)],2)):c("",!0)],2),s("div",{class:l(e.$style.formNavigation)},[C.value<(((m=p.value.questions)==null?void 0:m.length)||0)-1?(i(),n("button",{key:0,class:l([e.$style.navButton,e.$style.next]),onClick:me,disabled:!x.value},a[41]||(a[41]=[s("span",null,"السؤال التالي",-1),s("i",{class:"fas fa-arrow-left"},null,-1)]),10,ts)):c("",!0),C.value===(((f=p.value.questions)==null?void 0:f.length)||0)-1?(i(),n("button",{key:1,class:l([e.$style.navButton,e.$style.submit]),onClick:ee,disabled:!G.value||T.value},[T.value?(i(),n("i",is)):(i(),n("i",rs)),s("span",null,d(T.value?"جاري الإرسال...":"إرسال الاستطلاع"),1)],10,ns)):c("",!0),s("div",{class:l(e.$style.navSpacer)},null,2),C.value>0?(i(),n("button",{key:2,class:l(e.$style.navButton),onClick:ge},a[42]||(a[42]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"السؤال السابق",-1)]),2)):c("",!0)],2)]))],2)):c("",!0),we(g(Ee),{isVisible:z.value,onClose:Ce},null,8,["isVisible"])],10,Ve)}}}),ys={$style:Oe},ms=Se(ds,[["__cssModules",ys]]);export{ms as default};
