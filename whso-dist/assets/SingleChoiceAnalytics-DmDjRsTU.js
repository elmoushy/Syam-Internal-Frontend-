import{d as G,y as q,c as u,r as z,a as c,n as t,b as e,t as a,i as B,m as E,p as k,F as S,e as T,f as b,o as d,_ as U}from"./index-uWeSuK_C.js";import{H as W}from"./HorizontalBarChart-DIc203XA.js";const Y=["data-theme","dir"],j=["onClick"],J=G({__name:"MultipleChoiceAnalytics",props:{analytics:{},question:{},loading:{type:Boolean,default:!1},detailed:{type:Boolean,default:!1}},emits:["optionClick"],setup(L,{emit:I}){const r=L,N=I,m=q(),A=u(()=>m.currentTheme),D=u(()=>m.currentLanguage==="ar"),n=u(()=>m.t),v=z("popularity"),f=["#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#795548","#607D8B","#FF5722","#3F51B5","#009688","#CDDC39","#FFC107","#E91E63","#8BC34A","#00BCD4"],p=u(()=>{var l;if(!((l=r.analytics)!=null&&l.options))return[];const s=[...r.analytics.options];return v.value==="popularity"?s.sort((o,i)=>i.selection_count-o.selection_count):s.sort((o,i)=>o.option_text.localeCompare(i.option_text))}),R=u(()=>p.value.map(s=>({value:s.selection_count,percentage:s.selection_percentage}))),w=u(()=>p.value.map(s=>s.option_text)),C=u(()=>{var o,i;if(!((o=r.analytics)!=null&&o.total_responses)||!((i=r.analytics)!=null&&i.avg_selections_per_respondent))return 0;const s=r.analytics.avg_selections_per_respondent,l=r.analytics.total_responses;return s<=1.1?Math.round(l*.8):Math.round(l*(2-s))}),M=u(()=>r.analytics.total_responses-C.value),H=u(()=>{var o;if(!((o=r.analytics)!=null&&o.options))return 0;const s=Math.max(...r.analytics.options.map(i=>i.selection_count)),l=r.analytics.total_responses;return Math.ceil(s/Math.max(l*.1,1))}),g=u(()=>{var i;if(!((i=r.analytics)!=null&&i.options)||r.analytics.options.length===0)return[];const s=[],l=p.value,o=r.analytics.avg_selections_per_respondent||0;if(o<1.5?s.push({icon:"fas fa-user-check",color:"#4CAF50",title:n.value("survey.analytics.selectiveBehavior"),text:n.value("survey.analytics.selectiveBehaviorText")}):o>3&&s.push({icon:"fas fa-layer-group",color:"#2196F3",title:n.value("survey.analytics.comprehensiveBehavior"),text:n.value("survey.analytics.comprehensiveBehaviorText")}),l.length>0){const y=l[0];s.push({icon:"fas fa-trophy",color:"#FF9800",title:n.value("survey.analytics.topChoice"),text:`"${y.option_text}" ${n.value("survey.analytics.selectedBy")} ${$(y.respondent_count)} ${n.value("survey.analytics.users")}`})}if(l.length>=2){const y=l.slice(0,2);y[0].selection_count-y[1].selection_count<r.analytics.total_responses*.05&&s.push({icon:"fas fa-balance-scale",color:"#9C27B0",title:n.value("survey.analytics.evenDistribution"),text:n.value("survey.analytics.evenDistributionText")})}return s}),$=s=>!s&&s!==0?"0":new Intl.NumberFormat().format(s),V=s=>!s&&s!==0?"0.0":s.toFixed(1),h=s=>!s&&s!==0?"0%":`${(s*100).toFixed(1)}%`,O=(s,l)=>v.value==="popularity"?l+1:[...r.analytics.options].sort((i,y)=>y.selection_count-i.selection_count).findIndex(i=>i.option_id===s.option_id)+1,F=(s,l)=>{N("optionClick",s,l)};return(s,l)=>{var o;return d(),c("div",{class:t(s.$style.multipleChoiceAnalytics),"data-theme":A.value,dir:D.value?"rtl":"ltr"},[s.loading?(d(),c("div",{key:0,class:t(s.$style.loadingContainer)},[e("div",{class:t(s.$style.loadingSpinner)},null,2),e("p",{class:t(s.$style.loadingText)},a(n.value("survey.analytics.loadingAnalytics")),3)],2)):!s.analytics||!s.analytics.options?(d(),c("div",{key:1,class:t(s.$style.emptyContainer)},[e("div",{class:t(s.$style.emptyIcon)},l[2]||(l[2]=[e("i",{class:"fas fa-check-square"},null,-1)]),2),e("p",{class:t(s.$style.emptyText)},a(n.value("survey.analytics.noAnalyticsData")),3)],2)):(d(),c("div",{key:2,class:t(s.$style.analyticsContent)},[e("div",{class:t(s.$style.summarySection)},[e("div",{class:t(s.$style.summaryGrid)},[e("div",{class:t(s.$style.summaryCard)},[e("div",{class:t(s.$style.summaryIcon)},l[3]||(l[3]=[e("i",{class:"fas fa-users",style:{color:"#4CAF50"}},null,-1)]),2),e("div",{class:t(s.$style.summaryContent)},[e("div",{class:t(s.$style.summaryNumber)},a($(s.analytics.total_responses)),3),e("div",{class:t(s.$style.summaryLabel)},a(n.value("survey.analytics.totalResponses")),3)],2)],2),e("div",{class:t(s.$style.summaryCard)},[e("div",{class:t(s.$style.summaryIcon)},l[4]||(l[4]=[e("i",{class:"fas fa-chart-bar",style:{color:"#2196F3"}},null,-1)]),2),e("div",{class:t(s.$style.summaryContent)},[e("div",{class:t(s.$style.summaryNumber)},a($(s.analytics.total_selections)),3),e("div",{class:t(s.$style.summaryLabel)},a(n.value("survey.analytics.totalSelections")),3)],2)],2),e("div",{class:t(s.$style.summaryCard)},[e("div",{class:t(s.$style.summaryIcon)},l[5]||(l[5]=[e("i",{class:"fas fa-calculator",style:{color:"#FF9800"}},null,-1)]),2),e("div",{class:t(s.$style.summaryContent)},[e("div",{class:t(s.$style.summaryNumber)},a(V(s.analytics.avg_selections_per_respondent)),3),e("div",{class:t(s.$style.summaryLabel)},a(n.value("survey.analytics.avgSelectionsPerUser")),3)],2)],2),e("div",{class:t(s.$style.summaryCard)},[e("div",{class:t(s.$style.summaryIcon)},l[6]||(l[6]=[e("i",{class:"fas fa-star",style:{color:"#9C27B0"}},null,-1)]),2),e("div",{class:t(s.$style.summaryContent)},[e("div",{class:t(s.$style.summaryNumber)},a(((o=s.analytics.most_popular)==null?void 0:o.option_text)||"â€”"),3),e("div",{class:t(s.$style.summaryLabel)},a(n.value("survey.analytics.mostPopular")),3)],2)],2)],2)],2),e("div",{class:t(s.$style.optionsSection)},[e("div",{class:t(s.$style.chartContainer)},[e("div",{class:t(s.$style.chartHeader)},[e("h4",{class:t(s.$style.chartTitle)},a(n.value("survey.analytics.selectionFrequency")),3)],2),E(W,{data:R.value,colors:f,labels:w.value,loading:s.loading,onBarClick:F},null,8,["data","labels","loading"])],2),e("div",{class:t(s.$style.optionsList)},[e("div",{class:t(s.$style.optionsHeader)},[e("h4",{class:t(s.$style.optionsTitle)},a(n.value("survey.analytics.detailedBreakdown")),3),e("div",{class:t(s.$style.sortControls)},[e("button",{class:t([s.$style.sortButton,{[s.$style.active]:v.value==="popularity"}]),onClick:l[0]||(l[0]=i=>v.value="popularity")},[l[7]||(l[7]=e("i",{class:"fas fa-sort-amount-down"},null,-1)),k(" "+a(n.value("survey.analytics.byPopularity")),1)],2),e("button",{class:t([s.$style.sortButton,{[s.$style.active]:v.value==="alphabetical"}]),onClick:l[1]||(l[1]=i=>v.value="alphabetical")},[l[8]||(l[8]=e("i",{class:"fas fa-sort-alpha-down"},null,-1)),k(" "+a(n.value("survey.analytics.alphabetical")),1)],2)],2)],2),e("div",{class:t(s.$style.optionsGrid)},[(d(!0),c(S,null,T(p.value,(i,y)=>(d(),c("div",{key:i.option_id||y,class:t(s.$style.optionItem),onClick:P=>F(i,y)},[e("div",{class:t(s.$style.optionHeader)},[e("div",{class:t(s.$style.optionColor),style:b({backgroundColor:f[y]})},null,6),e("div",{class:t(s.$style.optionText)},a(i.option_text),3),e("div",{class:t(s.$style.optionBadge)},a(h(i.selection_percentage)),3)],2),e("div",{class:t(s.$style.optionStats)},[e("div",{class:t(s.$style.statRow)},[e("span",{class:t(s.$style.statLabel)},a(n.value("survey.analytics.timesSelected"))+":",3),e("span",{class:t(s.$style.statValue)},a($(i.selection_count)),3)],2),e("div",{class:t(s.$style.statRow)},[e("span",{class:t(s.$style.statLabel)},a(n.value("survey.analytics.byUsers"))+":",3),e("span",{class:t(s.$style.statValue)},a($(i.respondent_count)),3)],2),e("div",{class:t(s.$style.statRow)},[e("span",{class:t(s.$style.statLabel)},a(n.value("survey.analytics.responseRate"))+":",3),e("span",{class:t(s.$style.statValue)},a(h(i.respondent_percentage)),3)],2)],2),e("div",{class:t(s.$style.optionBar)},[e("div",{class:t(s.$style.optionBarFill),style:b({width:`${i.selection_percentage*100}%`,backgroundColor:f[y]})},null,6)],2),e("div",{class:t(s.$style.optionRank)}," #"+a(O(i,y)),3)],10,j))),128))],2),p.value.length===0?(d(),c("div",{key:0,class:t(s.$style.noOptions)},[e("div",{class:t(s.$style.noOptionsIcon)},l[9]||(l[9]=[e("i",{class:"fas fa-inbox"},null,-1)]),2),e("p",{class:t(s.$style.noOptionsText)},a(n.value("survey.analytics.noResponsesYet")),3)],2)):B("",!0)],2)],2),e("div",{class:t(s.$style.distributionSection)},[e("div",{class:t(s.$style.distributionHeader)},[e("h4",{class:t(s.$style.distributionTitle)},a(n.value("survey.analytics.selectionDistribution")),3)],2),e("div",{class:t(s.$style.distributionGrid)},[e("div",{class:t(s.$style.distributionCard)},[e("div",{class:t(s.$style.distributionIcon)},l[10]||(l[10]=[e("i",{class:"fas fa-users",style:{color:"#4CAF50"}},null,-1)]),2),e("div",{class:t(s.$style.distributionContent)},[e("div",{class:t(s.$style.distributionNumber)},a(C.value),3),e("div",{class:t(s.$style.distributionLabel)},a(n.value("survey.analytics.singleSelection")),3)],2)],2),e("div",{class:t(s.$style.distributionCard)},[e("div",{class:t(s.$style.distributionIcon)},l[11]||(l[11]=[e("i",{class:"fas fa-layer-group",style:{color:"#2196F3"}},null,-1)]),2),e("div",{class:t(s.$style.distributionContent)},[e("div",{class:t(s.$style.distributionNumber)},a(M.value),3),e("div",{class:t(s.$style.distributionLabel)},a(n.value("survey.analytics.multipleSelections")),3)],2)],2),e("div",{class:t(s.$style.distributionCard)},[e("div",{class:t(s.$style.distributionIcon)},l[12]||(l[12]=[e("i",{class:"fas fa-crown",style:{color:"#FF9800"}},null,-1)]),2),e("div",{class:t(s.$style.distributionContent)},[e("div",{class:t(s.$style.distributionNumber)},a(H.value),3),e("div",{class:t(s.$style.distributionLabel)},a(n.value("survey.analytics.maxSelections")),3)],2)],2)],2)],2),g.value.length>0?(d(),c("div",{key:0,class:t(s.$style.insightsSection)},[e("div",{class:t(s.$style.insightsHeader)},[e("h4",{class:t(s.$style.insightsTitle)},a(n.value("survey.analytics.insights")),3)],2),e("div",{class:t(s.$style.insightsGrid)},[(d(!0),c(S,null,T(g.value,(i,y)=>(d(),c("div",{key:y,class:t(s.$style.insightCard)},[e("div",{class:t(s.$style.insightIcon)},[e("i",{class:t(i.icon),style:b(`color: ${i.color}`)},null,6)],2),e("div",{class:t(s.$style.insightContent)},[e("h5",{class:t(s.$style.insightTitle)},a(i.title),3),e("p",{class:t(s.$style.insightText)},a(i.text),3)],2)],2))),128))],2)],2)):B("",!0)],2))],10,Y)}}}),K={},Q={$style:K},_=U(J,[["__cssModules",Q]]);export{_ as default};
