import{d as Y,y as Z,r as f,c as y,a as u,n as t,b as s,t as i,i as _,F as w,e as F,f as M,s as x,J as ee,p as G,q as se,o as c,_ as te}from"./index-uWeSuK_C.js";const le=["data-theme","dir"],ae=["onClick"],ne={value:"newest"},ie={value:"oldest"},oe={value:"longest"},re={value:"shortest"},ue=["onClick"],ce=["onClick"],ye=Y({__name:"TextAnalytics",props:{analytics:{},question:{},loading:{type:Boolean,default:!1},detailed:{type:Boolean,default:!1}},emits:["categoryClick","responseClick"],setup(N,{emit:V}){const r=N,k=V,C=Z(),h=f("characters"),b=f("newest"),q=f(5),p=f(new Set),E=y(()=>C.currentTheme),L=y(()=>C.currentLanguage==="ar"),n=y(()=>C.t),d=y(()=>{var e;return(e=r.analytics)!=null&&e.responses?r.analytics.responses.filter(a=>a.text&&a.text.trim().length>0).length:0}),R=y(()=>{var e;return((e=r.analytics)==null?void 0:e.total_responses)-d.value}),$=y(()=>{var a;if(!((a=r.analytics)!=null&&a.responses)||d.value===0)return 0;if(r.analytics.avg_length)return r.analytics.avg_length;const e=r.analytics.responses.filter(l=>l.text&&l.text.trim()).reduce((l,o)=>l+o.text.length,0);return Math.round(e/d.value)}),P=y(()=>{var a;if(!((a=r.analytics)!=null&&a.responses)||d.value===0)return 0;if(r.analytics.avg_words)return r.analytics.avg_words;const e=r.analytics.responses.filter(l=>l.text&&l.text.trim()).reduce((l,o)=>l+g(o.text),0);return Math.round(e/d.value)}),S=y(()=>{var e;return(e=r.analytics)!=null&&e.responses?r.analytics.responses.filter(a=>a.text&&a.text.trim().length>50&&g(a.text)>10).length:0}),I=y(()=>{var e;return(e=r.analytics)!=null&&e.responses?r.analytics.responses.filter(a=>a.text&&a.text.trim().length>0&&a.text.trim().length<=50).length:0}),T=y(()=>{var a;if(!((a=r.analytics)!=null&&a.responses))return[];const e=r.analytics.responses.filter(l=>l.text&&l.text.trim());return h.value==="words"?[{label:"1-5",description:n.value("survey.analytics.veryBrief"),count:e.filter(l=>{const o=g(l.text);return o>=1&&o<=5}).length,percentage:0},{label:"6-15",description:n.value("survey.analytics.brief"),count:e.filter(l=>{const o=g(l.text);return o>=6&&o<=15}).length,percentage:0},{label:"16-50",description:n.value("survey.analytics.moderate"),count:e.filter(l=>{const o=g(l.text);return o>=16&&o<=50}).length,percentage:0},{label:"51+",description:n.value("survey.analytics.detailed"),count:e.filter(l=>g(l.text)>50).length,percentage:0}].map(l=>({...l,percentage:e.length?l.count/e.length:0})):[{label:"1-50",description:n.value("survey.analytics.veryBrief"),count:e.filter(l=>l.text.length>=1&&l.text.length<=50).length,percentage:0},{label:"51-150",description:n.value("survey.analytics.brief"),count:e.filter(l=>l.text.length>=51&&l.text.length<=150).length,percentage:0},{label:"151-300",description:n.value("survey.analytics.moderate"),count:e.filter(l=>l.text.length>=151&&l.text.length<=300).length,percentage:0},{label:"301+",description:n.value("survey.analytics.detailed"),count:e.filter(l=>l.text.length>300).length,percentage:0}].map(l=>({...l,percentage:e.length?l.count/e.length:0}))}),W=y(()=>T.value.length?Math.max(...T.value.map(e=>e.count)):1),D=y(()=>{var a;if(!((a=r.analytics)!=null&&a.responses))return[];const e=[...r.analytics.responses].filter(l=>l.text&&l.text.trim());switch(b.value){case"oldest":return e.sort((l,o)=>!l.created_at||!o.created_at?0:new Date(l.created_at).getTime()-new Date(o.created_at).getTime());case"longest":return e.sort((l,o)=>o.text.length-l.text.length);case"shortest":return e.sort((l,o)=>l.text.length-o.text.length);case"newest":default:return e.sort((l,o)=>!l.created_at||!o.created_at?0:new Date(o.created_at).getTime()-new Date(l.created_at).getTime())}}),B=y(()=>D.value.slice(0,q.value).map((e,a)=>({...e,text:(p.value.has(a),e.text)}))),H=y(()=>{var o;if(!((o=r.analytics)!=null&&o.responses)||!d.value)return[];const e=[],a=d.value/r.analytics.total_responses;a>.8?e.push({icon:"fas fa-thumbs-up",color:"#4CAF50",title:n.value("survey.analytics.highEngagement"),text:`${m(a)} ${n.value("survey.analytics.providedTextResponses")}`}):a<.5&&e.push({icon:"fas fa-exclamation-triangle",color:"#FF9800",title:n.value("survey.analytics.lowEngagement"),text:n.value("survey.analytics.lowEngagementText")});const l=S.value/d.value;return l>.7?e.push({icon:"fas fa-star",color:"#FFD700",title:n.value("survey.analytics.highQualityResponses"),text:`${m(l)} ${n.value("survey.analytics.gaveDetailedAnswers")}`}):l<.3&&e.push({icon:"fas fa-edit",color:"#2196F3",title:n.value("survey.analytics.briefResponses"),text:n.value("survey.analytics.briefResponsesText")}),$.value>200?e.push({icon:"fas fa-align-left",color:"#9C27B0",title:n.value("survey.analytics.detailedResponses"),text:`${n.value("survey.analytics.averageLength")} ${$.value} ${n.value("survey.analytics.characters")}`}):$.value<50&&e.push({icon:"fas fa-compress",color:"#FF5722",title:n.value("survey.analytics.conciseResponses"),text:n.value("survey.analytics.conciseResponsesText")}),e}),v=e=>!e&&e!==0?"0":new Intl.NumberFormat().format(e),m=e=>!e&&e!==0?"0%":`${(e*100).toFixed(1)}%`,U=e=>{const a=new Date(e),l=L.value?"ar-SA":"en-US";return a.toLocaleDateString(l,{calendar:"gregory"})},g=e=>!e||!e.trim()?0:e.trim().split(/\s+/).length,z=e=>{const a=["#4CAF50","#8BC34A","#FF9800","#F44336"];return a[e%a.length]},Q=(e,a)=>e.length<=a?e:e.substring(0,a)+"...",J=()=>{q.value=5,p.value.clear()},O=()=>{q.value+=5},j=e=>{p.value.has(e)?p.value.delete(e):p.value.add(e)},K=(e,a)=>{k("categoryClick",e,a)},X=(e,a)=>{k("responseClick",e,a)};return(e,a)=>(c(),u("div",{class:t(e.$style.textAnalytics),"data-theme":E.value,dir:L.value?"rtl":"ltr"},[e.loading?(c(),u("div",{key:0,class:t(e.$style.loadingContainer)},[s("div",{class:t(e.$style.loadingSpinner)},null,2),s("p",{class:t(e.$style.loadingText)},i(n.value("survey.analytics.loadingAnalytics")),3)],2)):!e.analytics||!e.analytics.responses?(c(),u("div",{key:1,class:t(e.$style.emptyContainer)},[s("div",{class:t(e.$style.emptyIcon)},a[3]||(a[3]=[s("i",{class:"fas fa-comment-alt"},null,-1)]),2),s("p",{class:t(e.$style.emptyText)},i(n.value("survey.analytics.noAnalyticsData")),3)],2)):(c(),u("div",{key:2,class:t(e.$style.analyticsContent)},[s("div",{class:t(e.$style.summarySection)},[s("div",{class:t(e.$style.summaryGrid)},[s("div",{class:t(e.$style.summaryCard)},[s("div",{class:t(e.$style.summaryIcon)},a[4]||(a[4]=[s("i",{class:"fas fa-users",style:{color:"#4CAF50"}},null,-1)]),2),s("div",{class:t(e.$style.summaryContent)},[s("div",{class:t(e.$style.summaryNumber)},i(v(e.analytics.total_responses)),3),s("div",{class:t(e.$style.summaryLabel)},i(n.value("survey.analytics.totalResponses")),3)],2)],2),s("div",{class:t(e.$style.summaryCard)},[s("div",{class:t(e.$style.summaryIcon)},a[5]||(a[5]=[s("i",{class:"fas fa-align-left",style:{color:"#2196F3"}},null,-1)]),2),s("div",{class:t(e.$style.summaryContent)},[s("div",{class:t(e.$style.summaryNumber)},i(v($.value)),3),s("div",{class:t(e.$style.summaryLabel)},i(n.value("survey.analytics.avgLength")),3)],2)],2),s("div",{class:t(e.$style.summaryCard)},[s("div",{class:t(e.$style.summaryIcon)},a[6]||(a[6]=[s("i",{class:"fas fa-font",style:{color:"#FF9800"}},null,-1)]),2),s("div",{class:t(e.$style.summaryContent)},[s("div",{class:t(e.$style.summaryNumber)},i(v(P.value)),3),s("div",{class:t(e.$style.summaryLabel)},i(n.value("survey.analytics.avgWords")),3)],2)],2),s("div",{class:t(e.$style.summaryCard)},[s("div",{class:t(e.$style.summaryIcon)},a[7]||(a[7]=[s("i",{class:"fas fa-file-alt",style:{color:"#9C27B0"}},null,-1)]),2),s("div",{class:t(e.$style.summaryContent)},[s("div",{class:t(e.$style.summaryNumber)},i(v(d.value)),3),s("div",{class:t(e.$style.summaryLabel)},i(n.value("survey.analytics.filledResponses")),3)],2)],2)],2)],2),s("div",{class:t(e.$style.distributionSection)},[s("div",{class:t(e.$style.chartHeader)},[s("h4",{class:t(e.$style.chartTitle)},i(n.value("survey.analytics.lengthDistribution")),3),s("div",{class:t(e.$style.chartControls)},[s("button",{class:t([e.$style.controlButton,h.value==="characters"&&e.$style.active]),onClick:a[0]||(a[0]=l=>h.value="characters")},i(n.value("survey.analytics.characters")),3),s("button",{class:t([e.$style.controlButton,h.value==="words"&&e.$style.active]),onClick:a[1]||(a[1]=l=>h.value="words")},i(n.value("survey.analytics.words")),3)],2)],2),s("div",{class:t(e.$style.distributionChart)},[s("div",{class:t(e.$style.lengthBars)},[(c(!0),u(w,null,F(T.value,(l,o)=>(c(),u("div",{key:l.label,class:t(e.$style.lengthBar),onClick:A=>K(l,o)},[s("div",{class:t(e.$style.lengthLabel)},[s("span",{class:t(e.$style.categoryRange)},i(l.label),3),s("span",{class:t(e.$style.categoryDescription)},i(l.description),3)],2),s("div",{class:t(e.$style.lengthBarContainer)},[s("div",{class:t(e.$style.lengthBarFill),style:M({width:`${l.count/W.value*100}%`,backgroundColor:z(o)})},null,6)],2),s("div",{class:t(e.$style.lengthStats)},[s("span",{class:t(e.$style.categoryCount)},i(v(l.count)),3),s("span",{class:t(e.$style.categoryPercentage)},"("+i(m(l.percentage))+")",3)],2)],10,ae))),128))],2)],2)],2),s("div",{class:t(e.$style.qualitySection)},[s("div",{class:t(e.$style.qualityHeader)},[s("h4",{class:t(e.$style.qualityTitle)},i(n.value("survey.analytics.responseQuality")),3)],2),s("div",{class:t(e.$style.qualityGrid)},[s("div",{class:t(e.$style.qualityCard)},[s("div",{class:t(e.$style.qualityIcon)},a[8]||(a[8]=[s("i",{class:"fas fa-check-circle",style:{color:"#4CAF50"}},null,-1)]),2),s("div",{class:t(e.$style.qualityContent)},[s("div",{class:t(e.$style.qualityLabel)},i(n.value("survey.analytics.substantialResponses")),3),s("div",{class:t(e.$style.qualityValue)},i(v(S.value)),3),s("div",{class:t(e.$style.qualitySubtext)}," ("+i(m(S.value/d.value))+") ",3)],2)],2),s("div",{class:t(e.$style.qualityCard)},[s("div",{class:t(e.$style.qualityIcon)},a[9]||(a[9]=[s("i",{class:"fas fa-exclamation-triangle",style:{color:"#FF9800"}},null,-1)]),2),s("div",{class:t(e.$style.qualityContent)},[s("div",{class:t(e.$style.qualityLabel)},i(n.value("survey.analytics.briefResponses")),3),s("div",{class:t(e.$style.qualityValue)},i(v(I.value)),3),s("div",{class:t(e.$style.qualitySubtext)}," ("+i(m(I.value/d.value))+") ",3)],2)],2),s("div",{class:t(e.$style.qualityCard)},[s("div",{class:t(e.$style.qualityIcon)},a[10]||(a[10]=[s("i",{class:"fas fa-times-circle",style:{color:"#F44336"}},null,-1)]),2),s("div",{class:t(e.$style.qualityContent)},[s("div",{class:t(e.$style.qualityLabel)},i(n.value("survey.analytics.emptyResponses")),3),s("div",{class:t(e.$style.qualityValue)},i(v(R.value)),3),s("div",{class:t(e.$style.qualitySubtext)}," ("+i(m(R.value/e.analytics.total_responses))+") ",3)],2)],2)],2)],2),B.value.length>0?(c(),u("div",{key:0,class:t(e.$style.responsesSection)},[s("div",{class:t(e.$style.responsesHeader)},[s("h4",{class:t(e.$style.responsesTitle)},i(n.value("survey.analytics.recentResponses")),3),s("div",{class:t(e.$style.responsesControls)},[x(s("select",{"onUpdate:modelValue":a[2]||(a[2]=l=>b.value=l),class:t(e.$style.sortSelect),onChange:J},[s("option",ne,i(n.value("survey.analytics.newest")),1),s("option",ie,i(n.value("survey.analytics.oldest")),1),s("option",oe,i(n.value("survey.analytics.longest")),1),s("option",re,i(n.value("survey.analytics.shortest")),1)],34),[[ee,b.value]]),B.value.length<D.value.length?(c(),u("button",{key:0,class:t(e.$style.showMoreButton),onClick:O},i(n.value("survey.analytics.showMore")),3)):_("",!0)],2)],2),s("div",{class:t(e.$style.responsesList)},[(c(!0),u(w,null,F(B.value,(l,o)=>(c(),u("div",{key:o,class:t(e.$style.responseItem),onClick:A=>X(l,o)},[s("div",{class:t(e.$style.responseHeader)},[s("div",{class:t(e.$style.responseStats)},[s("span",{class:t(e.$style.responseStat)},[a[11]||(a[11]=s("i",{class:"fas fa-font"},null,-1)),G(" "+i(g(l.text))+" "+i(n.value("survey.analytics.words")),1)],2),s("span",{class:t(e.$style.responseStat)},[a[12]||(a[12]=s("i",{class:"fas fa-align-left"},null,-1)),G(" "+i(l.text.length)+" "+i(n.value("survey.analytics.chars")),1)],2)],2),l.created_at?(c(),u("div",{key:0,class:t(e.$style.responseDate)},i(U(l.created_at)),3)):_("",!0)],2),s("div",{class:t(e.$style.responseText)},i(Q(l.text,200)),3),l.text.length>200?(c(),u("div",{key:0,class:t(e.$style.responseFooter)},[s("button",{class:t(e.$style.expandButton),onClick:se(A=>j(o),["stop"])},i(p.value.has(o)?n.value("survey.analytics.showLess"):n.value("survey.analytics.showMore")),11,ce)],2)):_("",!0)],10,ue))),128))],2)],2)):_("",!0),H.value.length>0?(c(),u("div",{key:1,class:t(e.$style.insightsSection)},[s("div",{class:t(e.$style.insightsHeader)},[s("h4",{class:t(e.$style.insightsTitle)},i(n.value("survey.analytics.insights")),3)],2),s("div",{class:t(e.$style.insightsGrid)},[(c(!0),u(w,null,F(H.value,(l,o)=>(c(),u("div",{key:o,class:t(e.$style.insightCard)},[s("div",{class:t(e.$style.insightIcon)},[s("i",{class:t(l.icon),style:M(`color: ${l.color}`)},null,6)],2),s("div",{class:t(e.$style.insightContent)},[s("h5",{class:t(e.$style.insightTitle)},i(l.title),3),s("p",{class:t(e.$style.insightText)},i(l.text),3)],2)],2))),128))],2)],2)):_("",!0)],2))],10,le))}}),de="_textAnalytics_129li_3",ve="_loadingContainer_129li_11",ge="_emptyContainer_129li_13",pe="_loadingSpinner_129li_31",me="_spin_129li_1",he="_loadingText_129li_59",_e="_emptyText_129li_61",$e="_emptyIcon_129li_73",fe="_analyticsContent_129li_85",Ce="_summarySection_129li_99",be="_summaryGrid_129li_111",qe="_summaryCard_129li_123",Se="_summaryIcon_129li_143",Te="_summaryContent_129li_165",Be="_summaryNumber_129li_173",we="_summaryLabel_129li_189",Fe="_distributionSection_129li_205",ke="_chartHeader_129li_219",Le="_chartTitle_129li_237",Re="_chartControls_129li_251",Ie="_controlButton_129li_261",De="_active_129li_293",He="_distributionChart_129li_305",Ae="_lengthBars_129li_317",Me="_lengthBar_129li_317",Ge="_lengthLabel_129li_359",Ne="_categoryRange_129li_371",Ve="_categoryDescription_129li_383",Ee="_lengthBarContainer_129li_393",Pe="_lengthBarFill_129li_407",We="_lengthStats_129li_419",Ue="_categoryCount_129li_435",ze="_categoryPercentage_129li_447",Qe="_qualitySection_129li_459",Je="_qualityHeader_129li_473",Oe="_qualityTitle_129li_485",je="_qualityGrid_129li_499",Ke="_qualityCard_129li_511",Xe="_qualityIcon_129li_531",Ye="_qualityContent_129li_555",Ze="_qualityLabel_129li_563",xe="_qualityValue_129li_575",es="_qualitySubtext_129li_589",ss="_responsesSection_129li_603",ts="_responsesHeader_129li_617",ls="_responsesTitle_129li_635",as="_responsesControls_129li_649",ns="_sortSelect_129li_661",is="_showMoreButton_129li_679",os="_responsesList_129li_711",rs="_responseItem_129li_723",us="_responseHeader_129li_751",cs="_responseStats_129li_765",ys="_responseStat_129li_765",ds="_responseDate_129li_799",vs="_responseText_129li_809",gs="_responseFooter_129li_825",ps="_expandButton_129li_837",ms="_insightsSection_129li_867",hs="_insightsHeader_129li_881",_s="_insightsTitle_129li_893",$s="_insightsGrid_129li_907",fs="_insightCard_129li_919",Cs="_insightIcon_129li_937",bs="_insightContent_129li_961",qs="_insightTitle_129li_969",Ss="_insightText_129li_983",Ts={textAnalytics:de,loadingContainer:ve,emptyContainer:ge,loadingSpinner:pe,spin:me,loadingText:he,emptyText:_e,emptyIcon:$e,analyticsContent:fe,summarySection:Ce,summaryGrid:be,summaryCard:qe,summaryIcon:Se,summaryContent:Te,summaryNumber:Be,summaryLabel:we,distributionSection:Fe,chartHeader:ke,chartTitle:Le,chartControls:Re,controlButton:Ie,active:De,distributionChart:He,lengthBars:Ae,lengthBar:Me,lengthLabel:Ge,categoryRange:Ne,categoryDescription:Ve,lengthBarContainer:Ee,lengthBarFill:Pe,lengthStats:We,categoryCount:Ue,categoryPercentage:ze,qualitySection:Qe,qualityHeader:Je,qualityTitle:Oe,qualityGrid:je,qualityCard:Ke,qualityIcon:Xe,qualityContent:Ye,qualityLabel:Ze,qualityValue:xe,qualitySubtext:es,responsesSection:ss,responsesHeader:ts,responsesTitle:ls,responsesControls:as,sortSelect:ns,showMoreButton:is,responsesList:os,responseItem:rs,responseHeader:us,responseStats:cs,responseStat:ys,responseDate:ds,responseText:vs,responseFooter:gs,expandButton:ps,insightsSection:ms,insightsHeader:hs,insightsTitle:_s,insightsGrid:$s,insightCard:fs,insightIcon:Cs,insightContent:bs,insightTitle:qs,insightText:Ss},Bs={$style:Ts},Fs=te(ye,[["__cssModules",Bs]]);export{Fs as default};
