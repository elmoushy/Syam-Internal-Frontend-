import{d as B,r as f,c as L,g as F,h as V,a as i,i as w,n as r,u as e,b as t,t as z,o as l,j as H,w as U,k as q,l as W,F as N,e as O,f as j,m as J,p as Y,q as Z,s as T,v as K,x as Q}from"./index-C7bNMsZb.js";const X="_securityIndicator_mdavk_5",ee="_indicatorIcon_mdavk_33",te="_indicatorContent_mdavk_61",re="_indicatorText_mdavk_75",oe="_countdown_mdavk_83",ne="_secure_mdavk_99",se="_warning_mdavk_117",ae="_error_mdavk_135",ie="_pulse_mdavk_1",v={securityIndicator:X,indicatorIcon:ee,indicatorContent:te,indicatorText:re,countdown:oe,secure:ne,warning:se,error:ae,pulse:ie},le={key:0,viewBox:"0 0 16 16",fill:"none"},de={key:1,viewBox:"0 0 16 16",fill:"none"},ce={key:2,viewBox:"0 0 16 16",fill:"none"},ue=B({__name:"SecurityStatusIndicator",props:{attemptsRemaining:{default:0},maxAttempts:{default:5},retryAfter:{default:0},status:{default:"secure"},message:{},showCountdown:{type:Boolean,default:!1}},setup(A){const s=A,_=f(null),y=f(s.retryAfter),p=L(()=>s.status==="error"||s.attemptsRemaining===0?"error":s.status==="warning"||s.attemptsRemaining>0&&s.attemptsRemaining<=3?"warning":"secure"),I=L(()=>s.attemptsRemaining>0||s.retryAfter>0||s.message),x=L(()=>s.message?s.message:s.retryAfter>0?"Account locked. Try again in:":s.attemptsRemaining>0?s.attemptsRemaining===1?"⚠️ Last attempt remaining before account lockout":`⚠️ You have ${s.attemptsRemaining} login attempts remaining`:s.attemptsRemaining===0?"Account locked due to multiple failed attempts":"Login secure"),R=d=>{const c=Math.floor(d/60),C=d%60;return`${c.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`},k=()=>{s.retryAfter<=0||(y.value=s.retryAfter,_.value=window.setInterval(()=>{y.value--,y.value<=0&&S()},1e3))},S=()=>{_.value&&(clearInterval(_.value),_.value=null)};return F(()=>{s.showCountdown&&s.retryAfter>0&&k()}),V(()=>{S()}),(d,c)=>I.value?(l(),i("div",{key:0,class:r([e(v).securityIndicator,e(v)[p.value]])},[t("div",{class:r(e(v).indicatorIcon)},[d.status==="secure"?(l(),i("svg",le,c[0]||(c[0]=[t("path",{d:"M8 1l6 2v5c0 3.5-2.5 6.5-6 7-3.5-.5-6-3.5-6-7V3l6-2z",stroke:"currentColor","stroke-width":"1.5",fill:"none"},null,-1),t("path",{d:"M6 8l1.5 1.5L11 6",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):d.status==="warning"?(l(),i("svg",de,c[1]||(c[1]=[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 8 5zm.002 6a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1z",fill:"currentColor"},null,-1)]))):(l(),i("svg",ce,c[2]||(c[2]=[t("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor","stroke-width":"2"},null,-1),t("path",{d:"M8 4v4M8 10h.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])))],2),t("div",{class:r(e(v).indicatorContent)},[t("span",{class:r(e(v).indicatorText)},z(x.value),3),d.showCountdown&&d.retryAfter>0?(l(),i("div",{key:0,class:r(e(v).countdown)},z(R(d.retryAfter)),3)):w("",!0)],2)],2)):w("",!0)}}),pe="_loginPage_yzh1p_75",_e="_backgroundShift_yzh1p_1",ge="_meshRotate_yzh1p_1",ye="_backgroundLayer_yzh1p_201",me="_floatingParticles_yzh1p_221",he="_particle_yzh1p_239",ve="_particleFloat_yzh1p_1",fe="_gridOverlay_yzh1p_307",we="_gridPulse_yzh1p_1",ze="_pageContent_yzh1p_345",ke="_contentWrapper_yzh1p_361",be="_authCard_yzh1p_377",Se="_cardEntrance_yzh1p_1",Ce="_borderPulse_yzh1p_1",Ie="_cardHeader_yzh1p_523",xe="_headerShine_yzh1p_1",Re="_welcomeBadge_yzh1p_595",Le="_badgeFloat_yzh1p_1",Ae="_badgeSparkle_yzh1p_1",Te="_welcomeIcon_yzh1p_699",Be="_title_yzh1p_715",Fe="_titleGlow_yzh1p_1",Me="_subtitle_yzh1p_767",Pe="_cardBody_yzh1p_793",$e="_errorAlert_yzh1p_851",Ee="_errorSlide_yzh1p_1",De="_errorPulse_yzh1p_1",Ge="_errorIndicator_yzh1p_951",Ve="_errorBounce_yzh1p_1",He="_errorContent_yzh1p_987",Ue="_errorDismiss_yzh1p_1017",qe="_fieldErrorSlide_yzh1p_1",We="_loadingState_yzh1p_1275",Ne="_loadingContainer_yzh1p_1289",Oe="_loadingRotate_yzh1p_1",je="_loadingSpinner_yzh1p_1369",Je="_spinnerRing_yzh1p_1383",Ye="_spin_yzh1p_1383",Ze="_loadingText_yzh1p_1455",Ke="_loginSection_yzh1p_1499",Qe="_loginForm_yzh1p_1511",Xe="_formField_yzh1p_1525",et="_inputGroup_yzh1p_1539",tt="_formInput_yzh1p_1551",rt="_emailInput_yzh1p_1653",ot="_passwordInput_yzh1p_1671",nt="_floatingLabel_yzh1p_1691",st="_active_yzh1p_1739",at="_passwordToggle_yzh1p_1781",it="_fieldError_yzh1p_1875",lt="_errorShimmer_yzh1p_1",dt="_loginButton_yzh1p_1981",ct="_buttonSparkle_yzh1p_1",ut="_buttonText_yzh1p_2197",pt="_buttonRipple_yzh1p_2215",_t="_footer_yzh1p_2253",gt="_footerContent_yzh1p_2263",yt="_footerText_yzh1p_2319",mt="_highlight_yzh1p_2335",ht="_securityFeatures_yzh1p_2809",vt="_slideUpFade_yzh1p_1",ft="_slideIn_yzh1p_1",wt="_float_yzh1p_221",zt="_glow_yzh1p_1",kt="_pulse_yzh1p_1",o={loginPage:pe,backgroundShift:_e,meshRotate:ge,backgroundLayer:ye,floatingParticles:me,particle:he,particleFloat:ve,gridOverlay:fe,gridPulse:we,pageContent:ze,contentWrapper:ke,authCard:be,cardEntrance:Se,borderPulse:Ce,cardHeader:Ie,headerShine:xe,welcomeBadge:Re,badgeFloat:Le,badgeSparkle:Ae,welcomeIcon:Te,title:Be,titleGlow:Fe,subtitle:Me,cardBody:Pe,errorAlert:$e,errorSlide:Ee,errorPulse:De,errorIndicator:Ge,errorBounce:Ve,errorContent:He,errorDismiss:Ue,fieldErrorSlide:qe,loadingState:We,loadingContainer:Ne,loadingRotate:Oe,loadingSpinner:je,spinnerRing:Je,spin:Ye,loadingText:Ze,loginSection:Ke,loginForm:Qe,formField:Xe,inputGroup:et,formInput:tt,emailInput:rt,passwordInput:ot,floatingLabel:nt,active:st,passwordToggle:at,fieldError:it,errorShimmer:lt,loginButton:dt,buttonSparkle:ct,buttonText:ut,buttonRipple:pt,footer:_t,footerContent:gt,footerText:yt,highlight:mt,securityFeatures:ht,slideUpFade:vt,slideIn:ft,float:wt,glow:zt,pulse:kt},bt={key:0,style:{"margin-bottom":"1rem"}},St=["disabled"],Ct=["type","disabled"],It=["aria-label"],xt={key:0},Rt={key:1},Lt=["disabled"],Tt=B({__name:"JWTLogin",setup(A){const s=W(),_=q(),{isAuthenticated:y,isLoading:p,error:I,hasError:x,login:R,clearError:k,checkAuth:S,isAccountLocked:d,attemptsRemaining:c,lockoutTimeRemaining:C}=H(),m=f(""),h=f(""),b=f(!1),g=f({});U(y,a=>{if(a){const n=_.query.redirect||"/surveys";s.replace(n)}},{immediate:!1});const M=a=>{const n=Math.random()*4+2,u=Math.random()*20,E=Math.random()*10+15,D=Math.random()*100,G=Math.random()*100;return{width:`${n}px`,height:`${n}px`,left:`${D}%`,top:`${G}%`,animationDelay:`${u}s`,animationDuration:`${E}s`}},P=()=>{b.value=!b.value},$=async()=>{try{if(g.value={},k(),!m.value||!h.value||d.value)return;const a=await R(m.value,h.value);!a.success&&a.errors&&(a.errors.email&&(g.value.email=Array.isArray(a.errors.email)?a.errors.email[0]:a.errors.email),a.errors.password&&(g.value.password=Array.isArray(a.errors.password)?a.errors.password[0]:a.errors.password),a.errors.general&&Array.isArray(a.errors.general))}catch{}};return F(async()=>{try{if(await S(),y.value){const a=_.query.redirect||"/surveys";s.replace(a)}}catch{}}),(a,n)=>(l(),i("div",{class:r(e(o).loginPage),dir:"rtl"},[t("div",{class:r(e(o).backgroundLayer)},[t("div",{class:r(e(o).floatingParticles)},[(l(),i(N,null,O(12,u=>t("div",{key:u,class:r(e(o).particle),style:j(M())},null,6)),64))],2),t("div",{class:r(e(o).gridOverlay)},null,2)],2),t("div",{class:r(e(o).pageContent)},[t("div",{class:r(e(o).contentWrapper)},[t("div",{class:r(e(o).authCard)},[t("div",{class:r(e(o).cardHeader)},[t("div",{class:r(e(o).welcomeBadge)},[(l(),i("svg",{class:r(e(o).welcomeIcon),viewBox:"0 0 16 16",fill:"none"},n[3]||(n[3]=[t("path",{d:"M8 1L10.5 6H15L11.5 9.5L13 15L8 12L3 15L4.5 9.5L1 6H5.5L8 1Z",fill:"currentColor"},null,-1)]),2)),n[4]||(n[4]=t("span",null,"أهلاً وسهلاً",-1))],2),t("h1",{class:r(e(o).title)},"تسجيل الدخول",2),t("p",{class:r(e(o).subtitle)},"تسجيل الدخول عبر البريد الإلكتروني",2)],2),t("div",{class:r(e(o).cardBody)},[e(d)||e(c)>0?(l(),i("div",bt,[J(e(ue),{"attempts-remaining":e(c),"retry-after":e(C),status:e(d)?"error":e(c)<=3?"warning":"secure","show-countdown":e(d)},null,8,["attempts-remaining","retry-after","status","show-countdown"])])):w("",!0),e(x)?(l(),i("div",{key:1,class:r(e(o).errorAlert)},[t("div",{class:r(e(o).errorIndicator)},n[5]||(n[5]=[t("svg",{viewBox:"0 0 16 16",fill:"none"},[t("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor","stroke-width":"2"}),t("path",{d:"M8 4v4M8 10h.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)]),2),t("div",{class:r(e(o).errorContent)},[n[7]||(n[7]=t("h4",null,"فشل في تسجيل الدخول",-1)),t("p",null,z(e(I)),1),t("button",{onClick:n[0]||(n[0]=(...u)=>e(k)&&e(k)(...u)),class:r(e(o).errorDismiss)},n[6]||(n[6]=[t("svg",{viewBox:"0 0 16 16",fill:"none"},[t("path",{d:"M12 4L4 12M4 4l8 8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1),Y(" إغلاق ")]),2)],2)],2)):w("",!0),e(p)?(l(),i("div",{key:2,class:r(e(o).loadingState)},[t("div",{class:r(e(o).loadingContainer)},[t("div",{class:r(e(o).loadingSpinner)},[t("div",{class:r(e(o).spinnerRing)},null,2),t("div",{class:r(e(o).spinnerRing)},null,2),t("div",{class:r(e(o).spinnerRing)},null,2)],2),t("div",{class:r(e(o).loadingText)},n[8]||(n[8]=[t("h4",null,"جاري تسجيل الدخول",-1),t("p",null,"يتم إنشاء اتصال آمن...",-1)]),2)],2)],2)):(l(),i("div",{key:3,class:r(e(o).loginSection)},[t("form",{onSubmit:Z($,["prevent"]),class:r(e(o).loginForm)},[t("div",{class:r(e(o).formField)},[t("div",{class:r(e(o).inputGroup)},[T(t("input",{id:"email","onUpdate:modelValue":n[1]||(n[1]=u=>m.value=u),type:"email",class:r([e(o).formInput,e(o).emailInput]),placeholder:"",required:"",disabled:e(p),dir:"ltr"},null,10,St),[[K,m.value]]),t("label",{for:"email",class:r([e(o).floatingLabel,{[e(o).active]:m.value||e(p)}])}," البريد الإلكتروني ",2)],2),g.value.email?(l(),i("div",{key:0,class:r(e(o).fieldError)},z(g.value.email),3)):w("",!0)],2),t("div",{class:r(e(o).formField)},[t("div",{class:r(e(o).inputGroup)},[T(t("input",{id:"password","onUpdate:modelValue":n[2]||(n[2]=u=>h.value=u),type:b.value?"text":"password",class:r([e(o).formInput,e(o).passwordInput]),placeholder:"",required:"",disabled:e(p),dir:"ltr"},null,10,Ct),[[Q,h.value]]),t("label",{for:"password",class:r([e(o).floatingLabel,{[e(o).active]:h.value||e(p)}])}," كلمة المرور ",2),t("button",{type:"button",onClick:P,class:r(e(o).passwordToggle),"aria-label":b.value?"إخفاء كلمة المرور":"إظهار كلمة المرور",tabindex:"-1"},[b.value?(l(),i("span",xt,n[9]||(n[9]=[t("i",{class:"fas fa-eye-slash"},null,-1)]))):(l(),i("span",Rt,n[10]||(n[10]=[t("i",{class:"fas fa-eye"},null,-1)])))],10,It)],2),g.value.password?(l(),i("div",{key:0,class:r(e(o).fieldError)},z(g.value.password),3)):w("",!0)],2),t("button",{type:"submit",class:r(e(o).loginButton),disabled:e(p)||!m.value||!h.value||e(d)},[t("span",{class:r(e(o).buttonText)},z(e(d)?`محظور حتى ${Math.ceil(e(C)/60)} دقائق`:"تسجيل الدخول"),3),t("div",{class:r(e(o).buttonRipple)},null,2)],10,Lt)],34)],2))],2)],2)],2)],2)],2))}});export{Tt as default};
