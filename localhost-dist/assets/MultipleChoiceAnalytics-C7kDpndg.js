import{d as G,y as O,c as y,r as P,a as c,n as e,b as t,t as a,i as F,m as q,p as k,F as S,e as L,f,o as d,_ as E}from"./index-C7bNMsZb.js";import{H as U}from"./HorizontalBarChart-CEMzfcM-.js";const W=["data-theme","dir"],Y=["onClick"],J=G({__name:"MultipleChoiceAnalytics",props:{analytics:{},question:{},loading:{type:Boolean,default:!1},detailed:{type:Boolean,default:!1}},emits:["optionClick"],setup(T,{emit:z}){const r=T,I=z,$=O(),N=y(()=>$.currentTheme),j=y(()=>$.currentLanguage==="ar"),n=y(()=>$.t),v=P("popularity"),b=["#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#795548","#607D8B","#FF5722","#3F51B5","#009688","#CDDC39","#FFC107","#E91E63","#8BC34A","#00BCD4"],p=y(()=>{var l;if(!((l=r.analytics)!=null&&l.options))return[];const s=[...r.analytics.options];return v.value==="popularity"?s.sort((o,i)=>i.selection_count-o.selection_count):s.sort((o,i)=>o.option_text.localeCompare(i.option_text))}),R=y(()=>p.value.map(s=>({value:s.selection_count,percentage:s.selection_percentage}))),w=y(()=>p.value.map(s=>s.option_text)),C=y(()=>{var o,i;if(!((o=r.analytics)!=null&&o.total_responses)||!((i=r.analytics)!=null&&i.avg_selections_per_respondent))return 0;const s=r.analytics.avg_selections_per_respondent,l=r.analytics.total_responses;return s<=1.1?Math.round(l*.8):Math.round(l*(2-s))}),A=y(()=>r.analytics.total_responses-C.value),D=y(()=>{var o;if(!((o=r.analytics)!=null&&o.options))return 0;const s=Math.max(...r.analytics.options.map(i=>i.selection_count)),l=r.analytics.total_responses;return Math.ceil(s/Math.max(l*.1,1))}),g=y(()=>{var i;if(!((i=r.analytics)!=null&&i.options)||r.analytics.options.length===0)return[];const s=[],l=p.value,o=r.analytics.avg_selections_per_respondent||0;if(o<1.5?s.push({icon:"fas fa-user-check",color:"#4CAF50",title:n.value("survey.analytics.selectiveBehavior"),text:n.value("survey.analytics.selectiveBehaviorText")}):o>3&&s.push({icon:"fas fa-layer-group",color:"#2196F3",title:n.value("survey.analytics.comprehensiveBehavior"),text:n.value("survey.analytics.comprehensiveBehaviorText")}),l.length>0){const u=l[0];s.push({icon:"fas fa-trophy",color:"#FF9800",title:n.value("survey.analytics.topChoice"),text:`"${u.option_text}" ${n.value("survey.analytics.selectedBy")} ${m(u.respondent_count)} ${n.value("survey.analytics.users")}`})}if(l.length>=2){const u=l.slice(0,2);u[0].selection_count-u[1].selection_count<r.analytics.total_responses*.05&&s.push({icon:"fas fa-balance-scale",color:"#9C27B0",title:n.value("survey.analytics.evenDistribution"),text:n.value("survey.analytics.evenDistributionText")})}return s}),m=s=>!s&&s!==0?"0":new Intl.NumberFormat().format(s),H=s=>!s&&s!==0?"0.0":s.toFixed(1),h=s=>!s&&s!==0?"0%":`${(s*100).toFixed(1)}%`,M=(s,l)=>v.value==="popularity"?l+1:[...r.analytics.options].sort((i,u)=>u.selection_count-i.selection_count).findIndex(i=>i.option_id===s.option_id)+1,B=(s,l)=>{I("optionClick",s,l)};return(s,l)=>{var o;return d(),c("div",{class:e(s.$style.multipleChoiceAnalytics),"data-theme":N.value,dir:j.value?"rtl":"ltr"},[s.loading?(d(),c("div",{key:0,class:e(s.$style.loadingContainer)},[t("div",{class:e(s.$style.loadingSpinner)},null,2),t("p",{class:e(s.$style.loadingText)},a(n.value("survey.analytics.loadingAnalytics")),3)],2)):!s.analytics||!s.analytics.options?(d(),c("div",{key:1,class:e(s.$style.emptyContainer)},[t("div",{class:e(s.$style.emptyIcon)},l[2]||(l[2]=[t("i",{class:"fas fa-check-square"},null,-1)]),2),t("p",{class:e(s.$style.emptyText)},a(n.value("survey.analytics.noAnalyticsData")),3)],2)):(d(),c("div",{key:2,class:e(s.$style.analyticsContent)},[t("div",{class:e(s.$style.summarySection)},[t("div",{class:e(s.$style.summaryGrid)},[t("div",{class:e(s.$style.summaryCard)},[t("div",{class:e(s.$style.summaryIcon)},l[3]||(l[3]=[t("i",{class:"fas fa-users",style:{color:"#4CAF50"}},null,-1)]),2),t("div",{class:e(s.$style.summaryContent)},[t("div",{class:e(s.$style.summaryNumber)},a(m(s.analytics.total_responses)),3),t("div",{class:e(s.$style.summaryLabel)},a(n.value("survey.analytics.totalResponses")),3)],2)],2),t("div",{class:e(s.$style.summaryCard)},[t("div",{class:e(s.$style.summaryIcon)},l[4]||(l[4]=[t("i",{class:"fas fa-chart-bar",style:{color:"#2196F3"}},null,-1)]),2),t("div",{class:e(s.$style.summaryContent)},[t("div",{class:e(s.$style.summaryNumber)},a(m(s.analytics.total_selections)),3),t("div",{class:e(s.$style.summaryLabel)},a(n.value("survey.analytics.totalSelections")),3)],2)],2),t("div",{class:e(s.$style.summaryCard)},[t("div",{class:e(s.$style.summaryIcon)},l[5]||(l[5]=[t("i",{class:"fas fa-calculator",style:{color:"#FF9800"}},null,-1)]),2),t("div",{class:e(s.$style.summaryContent)},[t("div",{class:e(s.$style.summaryNumber)},a(H(s.analytics.avg_selections_per_respondent)),3),t("div",{class:e(s.$style.summaryLabel)},a(n.value("survey.analytics.avgSelectionsPerUser")),3)],2)],2),t("div",{class:e(s.$style.summaryCard)},[t("div",{class:e(s.$style.summaryIcon)},l[6]||(l[6]=[t("i",{class:"fas fa-star",style:{color:"#9C27B0"}},null,-1)]),2),t("div",{class:e(s.$style.summaryContent)},[t("div",{class:e(s.$style.summaryNumber)},a(((o=s.analytics.most_popular)==null?void 0:o.option_text)||"â€”"),3),t("div",{class:e(s.$style.summaryLabel)},a(n.value("survey.analytics.mostPopular")),3)],2)],2)],2)],2),t("div",{class:e(s.$style.optionsSection)},[t("div",{class:e(s.$style.chartContainer)},[t("div",{class:e(s.$style.chartHeader)},[t("h4",{class:e(s.$style.chartTitle)},a(n.value("survey.analytics.selectionFrequency")),3)],2),q(U,{data:R.value,colors:b,labels:w.value,loading:s.loading,onBarClick:B},null,8,["data","labels","loading"])],2),t("div",{class:e(s.$style.optionsList)},[t("div",{class:e(s.$style.optionsHeader)},[t("h4",{class:e(s.$style.optionsTitle)},a(n.value("survey.analytics.detailedBreakdown")),3),t("div",{class:e(s.$style.sortControls)},[t("button",{class:e([s.$style.sortButton,{[s.$style.active]:v.value==="popularity"}]),onClick:l[0]||(l[0]=i=>v.value="popularity")},[l[7]||(l[7]=t("i",{class:"fas fa-sort-amount-down"},null,-1)),k(" "+a(n.value("survey.analytics.byPopularity")),1)],2),t("button",{class:e([s.$style.sortButton,{[s.$style.active]:v.value==="alphabetical"}]),onClick:l[1]||(l[1]=i=>v.value="alphabetical")},[l[8]||(l[8]=t("i",{class:"fas fa-sort-alpha-down"},null,-1)),k(" "+a(n.value("survey.analytics.alphabetical")),1)],2)],2)],2),t("div",{class:e(s.$style.optionsGrid)},[(d(!0),c(S,null,L(p.value,(i,u)=>(d(),c("div",{key:i.option_id||u,class:e(s.$style.optionItem),onClick:V=>B(i,u)},[t("div",{class:e(s.$style.optionHeader)},[t("div",{class:e(s.$style.optionColor),style:f({backgroundColor:b[u]})},null,6),t("div",{class:e(s.$style.optionText)},a(i.option_text),3),t("div",{class:e(s.$style.optionBadge)},a(h(i.selection_percentage)),3)],2),t("div",{class:e(s.$style.optionStats)},[t("div",{class:e(s.$style.statRow)},[t("span",{class:e(s.$style.statLabel)},a(n.value("survey.analytics.timesSelected"))+":",3),t("span",{class:e(s.$style.statValue)},a(m(i.selection_count)),3)],2),t("div",{class:e(s.$style.statRow)},[t("span",{class:e(s.$style.statLabel)},a(n.value("survey.analytics.byUsers"))+":",3),t("span",{class:e(s.$style.statValue)},a(m(i.respondent_count)),3)],2),t("div",{class:e(s.$style.statRow)},[t("span",{class:e(s.$style.statLabel)},a(n.value("survey.analytics.responseRate"))+":",3),t("span",{class:e(s.$style.statValue)},a(h(i.respondent_percentage)),3)],2)],2),t("div",{class:e(s.$style.optionBar)},[t("div",{class:e(s.$style.optionBarFill),style:f({width:`${i.selection_percentage*100}%`,backgroundColor:b[u]})},null,6)],2),t("div",{class:e(s.$style.optionRank)}," #"+a(M(i,u)),3)],10,Y))),128))],2),p.value.length===0?(d(),c("div",{key:0,class:e(s.$style.noOptions)},[t("div",{class:e(s.$style.noOptionsIcon)},l[9]||(l[9]=[t("i",{class:"fas fa-inbox"},null,-1)]),2),t("p",{class:e(s.$style.noOptionsText)},a(n.value("survey.analytics.noResponsesYet")),3)],2)):F("",!0)],2)],2),t("div",{class:e(s.$style.distributionSection)},[t("div",{class:e(s.$style.distributionHeader)},[t("h4",{class:e(s.$style.distributionTitle)},a(n.value("survey.analytics.selectionDistribution")),3)],2),t("div",{class:e(s.$style.distributionGrid)},[t("div",{class:e(s.$style.distributionCard)},[t("div",{class:e(s.$style.distributionIcon)},l[10]||(l[10]=[t("i",{class:"fas fa-users",style:{color:"#4CAF50"}},null,-1)]),2),t("div",{class:e(s.$style.distributionContent)},[t("div",{class:e(s.$style.distributionNumber)},a(C.value),3),t("div",{class:e(s.$style.distributionLabel)},a(n.value("survey.analytics.singleSelection")),3)],2)],2),t("div",{class:e(s.$style.distributionCard)},[t("div",{class:e(s.$style.distributionIcon)},l[11]||(l[11]=[t("i",{class:"fas fa-layer-group",style:{color:"#2196F3"}},null,-1)]),2),t("div",{class:e(s.$style.distributionContent)},[t("div",{class:e(s.$style.distributionNumber)},a(A.value),3),t("div",{class:e(s.$style.distributionLabel)},a(n.value("survey.analytics.multipleSelections")),3)],2)],2),t("div",{class:e(s.$style.distributionCard)},[t("div",{class:e(s.$style.distributionIcon)},l[12]||(l[12]=[t("i",{class:"fas fa-crown",style:{color:"#FF9800"}},null,-1)]),2),t("div",{class:e(s.$style.distributionContent)},[t("div",{class:e(s.$style.distributionNumber)},a(D.value),3),t("div",{class:e(s.$style.distributionLabel)},a(n.value("survey.analytics.maxSelections")),3)],2)],2)],2)],2),g.value.length>0?(d(),c("div",{key:0,class:e(s.$style.insightsSection)},[t("div",{class:e(s.$style.insightsHeader)},[t("h4",{class:e(s.$style.insightsTitle)},a(n.value("survey.analytics.insights")),3)],2),t("div",{class:e(s.$style.insightsGrid)},[(d(!0),c(S,null,L(g.value,(i,u)=>(d(),c("div",{key:u,class:e(s.$style.insightCard)},[t("div",{class:e(s.$style.insightIcon)},[t("i",{class:e(i.icon),style:f(`color: ${i.color}`)},null,6)],2),t("div",{class:e(s.$style.insightContent)},[t("h5",{class:e(s.$style.insightTitle)},a(i.title),3),t("p",{class:e(s.$style.insightText)},a(i.text),3)],2)],2))),128))],2)],2)):F("",!0)],2))],10,W)}}}),K="_sortControls_zpjl6_5",Q="_sortButton_zpjl6_15",X="_active_zpjl6_45",Z="_statRow_zpjl6_57",_="_statLabel_zpjl6_73",x="_statValue_zpjl6_81",ss="_distributionSection_zpjl6_91",ts="_distributionHeader_zpjl6_105",es="_distributionTitle_zpjl6_117",ls="_distributionGrid_zpjl6_131",as="_distributionCard_zpjl6_143",is="_distributionIcon_zpjl6_163",ns="_distributionContent_zpjl6_185",os="_distributionNumber_zpjl6_193",rs="_distributionLabel_zpjl6_209",us={sortControls:K,sortButton:Q,active:X,statRow:Z,statLabel:_,statValue:x,distributionSection:ss,distributionHeader:ts,distributionTitle:es,distributionGrid:ls,distributionCard:as,distributionIcon:is,distributionContent:ns,distributionNumber:os,distributionLabel:rs},ys={$style:us},vs=E(J,[["__cssModules",ys]]);export{vs as default};
